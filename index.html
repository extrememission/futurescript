<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FutureScript</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts and Material Icons -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --primary: #2563eb;
      --accent: #fbbf24;
      --bg: #f8fafc;
      --panel: #fff;
      --border: #e0e0e0;
      --text: #1e293b;
      --muted: #64748b;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Roboto', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .container {
      display: flex;
      flex: 1 1 0;
      min-height: 100vh;
    }
    .left, .right {
      padding: 2rem 1.5rem;
      box-sizing: border-box;
      background: var(--panel);
    }
    .left {
      flex: 1 1 50%;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      min-width: 340px;
      max-width: 600px;
    }
    .right {
      flex: 1 1 50%;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      min-width: 340px;
      max-width: 600px;
    }
    h1 {
      font-weight: 500;
      letter-spacing: -1px;
      margin-top: 0;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 0.5em;
    }
    .tagline {
      font-size: 1.1em;
      color: var(--muted);
      margin-bottom: 2rem;
    }
    .chain {
      margin: 1.5em 0;
      padding: 1.5em 1em;
      background: #f1f5f9;
      border-radius: 10px;
      box-shadow: 0 2px 8px #0001;
      font-size: 1.08em;
    }
    .chain-row {
      display: flex;
      align-items: center;
      margin-bottom: 1.2em;
    }
    .chain-row:last-child {
      margin-bottom: 0;
    }
    .chain-label {
      min-width: 120px;
      font-weight: 500;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .chain-arrow {
      font-size: 1.4em;
      color: var(--muted);
      margin: 0 0.6em;
    }
    .chain-value {
      flex: 1;
      background: #fff;
      border-radius: 5px;
      padding: 0.5em 0.7em;
      min-height: 2.2em;
      box-shadow: 0 1px 2px #0001;
      color: var(--text);
      font-size: 1.04em;
      word-break: break-word;
    }
    .input-section {
      margin-bottom: 2.2rem;
    }
    .input-section label {
      font-weight: 500;
      font-size: 1.08em;
      margin-bottom: 0.5em;
      display: block;
      color: var(--primary);
    }
    .input-section input,
    .input-section textarea {
      width: 100%;
      padding: 0.7em;
      margin-top: 0.3em;
      margin-bottom: 1em;
      font-size: 1em;
      border: 1.5px solid var(--border);
      border-radius: 5px;
      background: #f1f5f9;
      color: var(--text);
      font-family: inherit;
      resize: vertical;
    }
    .input-section textarea {
      min-height: 60px;
      max-height: 240px;
    }
    .save-btn {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 0.8em 1.8em;
      font-size: 1.1em;
      font-weight: 500;
      cursor: pointer;
      margin-top: 1.5em;
      transition: background 0.2s;
      box-shadow: 0 2px 8px #0001;
    }
    .save-btn:hover {
      background: #1742a2;
    }
    .history-panel {
      margin-top: 2.5rem;
      width: 100%;
      background: #f1f5f9;
      border-radius: 10px;
      padding: 1.2rem 1rem;
      box-shadow: 0 2px 8px #0001;
    }
    .history-title {
      font-size: 1.1em;
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 0.7em;
      display: flex;
      align-items: center;
      gap: 0.3em;
    }
    .history-list {
      list-style: none;
      padding: 0;
      margin: 0;
      max-height: 180px;
      overflow-y: auto;
    }
    .history-list li {
      margin-bottom: 0.4em;
    }
    .history-btn {
      background: none;
      color: var(--primary);
      border: none;
      cursor: pointer;
      text-decoration: underline;
      font-size: 1em;
      padding: 0;
    }
    .history-btn:hover {
      color: var(--accent);
    }
    .summary-panel {
      width: 100%;
      margin-top: 2.5rem;
      background: #f1f5f9;
      border-radius: 10px;
      padding: 2rem 1.5rem;
      box-shadow: 0 2px 8px #0001;
      min-height: 180px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .summary-panel .material-icons {
      vertical-align: middle;
      color: var(--accent);
      font-size: 1.5em;
      margin-right: 0.3em;
    }
    .summary-title {
      font-size: 1.2em;
      font-weight: 500;
      margin-bottom: 1em;
      color: var(--primary);
      display: flex;
      align-items: center;
    }
    .summary-text {
      font-size: 1.12em;
      color: var(--text);
      line-height: 1.5;
    }
    .reset-btn {
      background: none;
      color: var(--muted);
      border: none;
      font-size: 1em;
      margin-top: 1.5em;
      cursor: pointer;
      text-decoration: underline;
      padding: 0;
    }
    @media (max-width: 900px) {
      .container {
        flex-direction: column;
      }
      .left, .right {
        min-width: 0;
        width: 100%;
        padding: 1rem;
      }
      .summary-panel {
        padding: 1.2rem;
      }
      .history-panel {
        padding: 1rem 0.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="left">
      <h1>
        <span class="material-icons">auto_awesome</span>
        FutureScript
      </h1>
      <div class="tagline">
        Choose what you want to create, change, or achieve. Weâ€™ll help you map the path forward.
      </div>
      <form id="futurescriptForm" autocomplete="off"></form>
      <div class="chain" id="chainDisplay"></div>
      <button class="save-btn" id="saveBtn" type="button">Save This FutureScript</button>
      <div class="history-panel" id="historyPanel">
        <div class="history-title">
          <span class="material-icons">history</span>
          Your FutureScript History
        </div>
        <ul class="history-list" id="historyList"></ul>
      </div>
    </div>
    <div class="right">
      <div class="summary-panel" id="summaryPanel">
        <div class="summary-title">
          <span class="material-icons">insights</span>
          Your FutureScript
        </div>
        <div class="summary-text" id="summaryText">
          Start building your FutureScript on the left!
        </div>
      </div>
      <button class="reset-btn" id="resetBtn" style="display:none;">Start New FutureScript</button>
    </div>
  </div>
  <script>
    // The FutureScript causal chain
    const chain = [
      {
        key: 'circumstance',
        label: 'Situation',
        icon: 'public',
        prompt: "What's the situation or context for your FutureScript?",
        placeholder: "e.g., I am starting a new job"
      },
      {
        key: 'mindset',
        label: 'Mindset',
        icon: 'psychology',
        prompt: "What mindset will you choose in this situation?",
        placeholder: "e.g., I am resourceful and ready"
      },
      {
        key: 'feeling',
        label: 'Feeling',
        icon: 'favorite',
        prompt: "What feeling will this mindset create? (one word)",
        placeholder: "e.g., Confident"
      },
      {
        key: 'action',
        label: 'Action',
        icon: 'directions_run',
        prompt: "What action will this feeling inspire?",
        placeholder: "e.g., I will introduce myself and ask questions"
      },
      {
        key: 'result',
        label: 'Result',
        icon: 'emoji_events',
        prompt: "What result will these actions create in your FutureScript?",
        placeholder: "e.g., I build strong relationships and succeed at work"
      }
    ];

    // Causal connectors for display
    const connectors = [
      "triggers",
      "produces",
      "generates",
      "causes"
    ];

    // State
    let userEntries = {};
    let editingTimestamp = null;

    // Render the dynamic input form
    function renderForm() {
      const form = document.getElementById('futurescriptForm');
      form.innerHTML = '';
      chain.forEach((step, idx) => {
        const div = document.createElement('div');
        div.className = 'input-section';
        const lbl = document.createElement('label');
        lbl.htmlFor = step.key + '-input';
        lbl.textContent = step.label;
        div.appendChild(lbl);

        const small = document.createElement('div');
        small.style.fontSize = '0.97em';
        small.style.color = 'var(--muted)';
        small.style.marginBottom = '0.3em';
        small.textContent = step.prompt;
        div.appendChild(small);

        let input;
        if (step.key === 'feeling') {
          input = document.createElement('input');
          input.type = 'text';
        } else {
          input = document.createElement('textarea');
          input.rows = 2;
        }
        input.id = step.key + '-input';
        input.placeholder = step.placeholder;
        input.value = userEntries[step.key] || '';
        input.oninput = () => {
          userEntries[step.key] = input.value;
          renderChain();
          renderSummary();
        };
        div.appendChild(input);
        form.appendChild(div);
      });
    }

    // Render the dynamic chain display
    function renderChain() {
      const chainDiv = document.getElementById('chainDisplay');
      chainDiv.innerHTML = '';
      chain.forEach((step, idx) => {
        const row = document.createElement('div');
        row.className = 'chain-row';
        // Label and icon
        const label = document.createElement('div');
        label.className = 'chain-label';
        label.innerHTML = `<span class="material-icons">${step.icon}</span>${step.label}`;
        row.appendChild(label);
        // Arrow
        if (idx > 0) {
          const arrow = document.createElement('span');
          arrow.className = 'chain-arrow material-icons';
          arrow.textContent = 'arrow_downward';
          chainDiv.appendChild(arrow);
        }
        // Value
        const value = document.createElement('div');
        value.className = 'chain-value';
        value.textContent = userEntries[step.key] || '';
        row.appendChild(value);
        chainDiv.appendChild(row);
        // Connector
        if (idx < connectors.length) {
          const conn = document.createElement('div');
          conn.style.textAlign = 'center';
          conn.style.color = 'var(--muted)';
          conn.style.fontSize = '0.98em';
          conn.style.margin = '0.1em 0 0.4em 0';
          conn.textContent = connectors[idx];
          chainDiv.appendChild(conn);
        }
      });
    }

    // Compose the summary sentence
    function renderSummary() {
      const summaryText = document.getElementById('summaryText');
      const resetBtn = document.getElementById('resetBtn');
      // Check if all fields filled
      const allFilled = chain.every(step => (userEntries[step.key] || '').trim().length > 0);
      if (!allFilled) {
        summaryText.innerHTML = `<span style="color:var(--muted);">Complete your FutureScript on the left to see your summary here.</span>`;
        resetBtn.style.display = 'none';
        return;
      }
      // Compose summary
      const e = userEntries;
      const summary = `
        In your FutureScript, the situation is: <b>${e.circumstance}</b>.
        <br><br>
        This situation triggers the mindset: <b>${e.mindset}</b>, which produces the feeling: <b>${e.feeling}</b>.
        <br><br>
        That feeling generates the action: <b>${e.action}</b>, which causes the result: <b>${e.result}</b>.
        <br><br>
        <span style="color:var(--accent);font-weight:500;">This is your FutureScriptâ€”your plan for creating the future you want.</span>
      `;
      summaryText.innerHTML = summary;
      resetBtn.style.display = 'inline-block';
    }

    // Save session to localStorage
    function saveSession() {
      const allFilled = chain.every(step => (userEntries[step.key] || '').trim().length > 0);
      if (!allFilled) {
        alert('Please complete all fields before saving your FutureScript.');
        return;
      }
      const scripts = getScripts();
      const timestamp = editingTimestamp || new Date().toISOString();
      scripts[timestamp] = {
        ...userEntries,
        saved: timestamp
      };
      localStorage.setItem('futurescript_sessions', JSON.stringify(scripts));
      editingTimestamp = null;
      renderHistory();
      alert('Your FutureScript has been saved!');
    }

    // Load all scripts from localStorage
    function getScripts() {
      return JSON.parse(localStorage.getItem('futurescript_sessions') || '{}');
    }

    // Render history panel
    function renderHistory() {
      const scripts = getScripts();
      const historyList = document.getElementById('historyList');
      historyList.innerHTML = '';
      const sorted = Object.keys(scripts).sort((a, b) => b.localeCompare(a));
      if (sorted.length === 0) {
        historyList.innerHTML = '<li style="color:var(--muted);font-size:0.98em;">No saved FutureScripts yet.</li>';
        return;
      }
      sorted.forEach(ts => {
        const li = document.createElement('li');
        const btn = document.createElement('button');
        btn.className = 'history-btn';
        const date = new Date(ts);
        btn.textContent = date.toLocaleString();
        btn.onclick = () => {
          userEntries = { ...scripts[ts] };
          editingTimestamp = ts;
          renderForm();
          renderChain();
          renderSummary();
        };
        li.appendChild(btn);
        historyList.appendChild(li);
      });
    }

    // Reset everything
    document.getElementById('resetBtn').onclick = () => {
      userEntries = {};
      editingTimestamp = null;
      renderForm();
      renderChain();
      renderSummary();
    };

    // Save button
    document.getElementById('saveBtn').onclick = saveSession;

    // Initial render
    renderForm();
    renderChain();
    renderSummary();
    renderHistory();
  </script>
</body>
</html>
